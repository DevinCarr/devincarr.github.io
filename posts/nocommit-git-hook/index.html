<!doctype html><html><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"><link rel=canonical href=https://devincarr.com><meta property="og:title" content="&#34;nocommit&#34; Git Hook"><meta property="og:description" content="Git Hooks are an interesting way to customize your daily git workflow. They can allow you to trigger on specific events (before and after) common tasks such as: committing (via &lsquo;pre-commit&rsquo;) and pushing (via &lsquo;pre-push&rsquo;). Specific examples of how to run these each are located in your ."><meta property="og:type" content="article"><meta property="og:url" content="http://devincarr.com/posts/nocommit-git-hook/"><meta property="article:published_time" content="2020-04-27T21:40:02-07:00"><meta property="article:modified_time" content="2020-04-27T21:40:02-07:00"><meta property="og:site_name" content="Devin Carr"><link rel=stylesheet href=/milligram.min.css><link rel=stylesheet href=/main.css><title>Devin Carr</title></head><body><section class="post container"><div class=row><div class="column timestamp"><small>April 27, 2020</small></div></div><div class=row><article class=column><h2>"nocommit" Git Hook</h2><hr><p><a href=https://git-scm.com/book/en/v2/Customizing-Git-Git-Hooks>Git Hooks</a> are an interesting way to customize your daily git workflow. They can allow you to trigger on specific events (before and after) common tasks such as: committing (via &lsquo;pre-commit&rsquo;) and pushing (via &lsquo;pre-push&rsquo;). Specific examples of how to run these each are located in your <code>.git/hooks/</code> folder with the extension <code>.sample</code>.</p><h1 id=nocommit>nocommit</h1><p>One of the <code>pre-commit</code> git hooks that I utilize is &lsquo;nocommit&rsquo;. It ensures that I do not have any lines of code that have the word &ldquo;nocommit&rdquo; in them before commiting the changes. I typically use this to help mark lines of code that I will temporarly edit but would require a follow up before commiting/pushing upstream.</p><p>This helps my common workflow which typically involves:</p><ol><li>Writing source ad-hoc to get a code path running</li><li>Iterate on a solution</li><li>Make slight notes via <code>// nocommit:</code> comments as insights appear</li><li>Continue testing</li><li>Follow up on ad-hoc solution areas to increase robustness/better comments.</li></ol><p>The key here is to not allow myself to skip out on the last step which typically involves expanding a comment into something more meaningful for the content/context involved. With <code>nocommit</code> comments I can make sure that they are resolved completely before even creating a commit.</p><h2 id=why-nocommit-why-not-todo>Why nocommit, why not TODO</h2><p>Initially I would have utilized the keyword TODO to accomplish the similar goal but because it is well known. The problem is that it typically is already checked in at my work, thus triggering too often on changes that that aren't related to me. Mostly because previous engineers would commit their TODOs in and never follow back up on the actual tasks ascribed by the TODO. So for the sake of simplicity, I have opted to for a different keyword: <code>nocommit</code>.</p><h2 id=source>Source</h2><p>A pre-requistes is to have the latest PowerShell 7 installed and available on the path as <code>pwsh</code> (which is done by default when installed).</p><p><code>.git/hooks/pre-commit</code>:</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=color:green>#!/usr/bin/env pwsh</span>

$changes = $(git diff --name-only).Split(<span style=color:#a31515>&#34;</span><span style=color:#a31515>\r?\n</span><span style=color:#a31515>&#34;</span>)
$nocommits = Get-ChildItem -Recurse $changes | Select-String <span style=color:#a31515>&#34;</span><span style=color:#a31515>nocommit</span><span style=color:#a31515>&#34;</span>;
<span style=color:#00f>if</span> ($nocommits.Count -gt 0) {
    Write-Output <span style=color:#a31515>&#34;</span><span style=color:#a31515>Error(pre-commit): &#39;nocommit&#39;s found in source:</span><span style=color:#a31515>&#34;</span>
    $nocommits
    exit 1
}

exit 0
</code></pre></div><h3 id=example-output>Example Output</h3><pre><code>$ git commit -m &quot;test&quot;
Error(pre-commit): 'nocommit's found in source:

Database\Program.cs:37:            // nocommit: correct this logger instance
Database\Program.cs:39:            // nocommit: expand comment
</code></pre></article></div></section><div class="post container"><div class=row><div class="column column-75"><small><a href=http://devincarr.com/>Devin Carr</a> /
<a href=http://devincarr.com/posts/>Posts</a> /
<a href=http://devincarr.com/posts/nocommit-git-hook/>"nocommit" Git Hook</a> /</small></div><div class=column><div class=copyright>Copyright Devin Carr Â© 2020</div></div></div></div></body></html>